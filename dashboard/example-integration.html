<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Charts - Integration Example | Somali Dialect Classifier</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Chart.js and Plugins -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>

    <!-- Enhanced Chart Configuration -->
    <script src="chart-config-enhanced.js"></script>
    <script src="enhanced-charts.js"></script>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="enhanced-charts.css">

    <style>
        /* Basic layout styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #F9FAFB;
            color: #111827;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        header {
            background: linear-gradient(135deg, #2563EB 0%, #1E40AF 100%);
            color: white;
            padding: 48px 24px;
            margin-bottom: 40px;
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 3px solid #2563EB;
        }

        .section {
            margin-bottom: 64px;
        }

        .info-box {
            background: #EFF6FF;
            border-left: 4px solid #2563EB;
            padding: 16px 20px;
            margin-bottom: 24px;
            border-radius: 6px;
        }

        .info-box h3 {
            font-size: 1rem;
            font-weight: 600;
            color: #1E40AF;
            margin-bottom: 8px;
        }

        .info-box p {
            font-size: 0.875rem;
            color: #1E3A8A;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .feature-item {
            background: white;
            padding: 16px;
            border-radius: 8px;
            border: 1px solid #E5E7EB;
        }

        .feature-item strong {
            display: block;
            color: #2563EB;
            margin-bottom: 4px;
            font-size: 0.875rem;
        }

        .feature-item span {
            font-size: 0.875rem;
            color: #6B7280;
        }

        code {
            background: #F3F4F6;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.875rem;
            }

            .container {
                padding: 24px 16px;
            }

            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Skip to content link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Header -->
    <header role="banner">
        <h1>Enhanced Data Visualizations</h1>
        <p class="subtitle">
            Accessibility-first, interactive Chart.js implementations with
            colorblind-safe palettes and mobile optimization
        </p>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container">

        <!-- Introduction Section -->
        <section class="section">
            <div class="info-box">
                <h3>üéØ What's New in Version 2.0</h3>
                <p>
                    This page demonstrates the enhanced chart implementations with improved
                    accessibility, interactivity, and performance. All charts are keyboard-navigable,
                    screen reader compatible, and optimized for mobile devices.
                </p>
            </div>

            <div class="feature-list">
                <div class="feature-item">
                    <strong>üé® Colorblind-Safe</strong>
                    <span>Paul Tol's palette verified for all colorblind types</span>
                </div>
                <div class="feature-item">
                    <strong>‚å®Ô∏è Keyboard Navigation</strong>
                    <span>Arrow keys to navigate, R to reset zoom</span>
                </div>
                <div class="feature-item">
                    <strong>üîç Zoom & Pan</strong>
                    <span>Mouse wheel and pinch gestures supported</span>
                </div>
                <div class="feature-item">
                    <strong>üìä Data Export</strong>
                    <span>Download chart data as CSV</span>
                </div>
                <div class="feature-item">
                    <strong>üì± Mobile Optimized</strong>
                    <span>Touch-friendly with responsive sizing</span>
                </div>
                <div class="feature-item">
                    <strong>‚ôø WCAG AA Compliant</strong>
                    <span>Full screen reader and keyboard support</span>
                </div>
            </div>
        </section>

        <!-- Example 1: Time Series Chart -->
        <section class="section">
            <h2>Example 1: Enhanced Time Series Chart</h2>

            <div class="info-box">
                <h3>Features Demonstrated</h3>
                <p>
                    Multi-source comparison, zoom/pan, crosshair, keyboard navigation,
                    and cumulative totals in legend. Try scrolling to zoom or using arrow keys to navigate.
                </p>
            </div>

            <div class="chart-container" role="region" aria-labelledby="chart1-title">
                <h3 id="chart1-title" class="sr-only">Records Processed Over Time</h3>
                <div class="chart-canvas">
                    <canvas id="timeSeriesChart" aria-label="Line chart showing records processed over time by each data source"></canvas>
                </div>
                <div class="chart-keyboard-hint">
                    üí° Use arrow keys to navigate data points, R to reset zoom, Escape to clear
                </div>
            </div>
        </section>

        <!-- Example 2: Source Comparison Chart -->
        <section class="section">
            <h2>Example 2: Enhanced Bar Chart</h2>

            <div class="info-box">
                <h3>Features Demonstrated</h3>
                <p>
                    Horizontal bars with percentages, click-to-filter functionality,
                    and data export. Click on any bar to see filtering in action.
                </p>
            </div>

            <div class="chart-container" role="region" aria-labelledby="chart2-title">
                <h3 id="chart2-title" class="sr-only">Source Contribution Comparison</h3>
                <div class="chart-canvas">
                    <canvas id="sourceChart" aria-label="Bar chart comparing total records from each data source"></canvas>
                </div>
                <div class="chart-keyboard-hint">
                    üí° Click on bars to filter, or use arrow keys to select and Enter to activate
                </div>
            </div>
        </section>

        <!-- Example 3: Funnel Chart -->
        <section class="section">
            <h2>Example 3: Enhanced Funnel Chart</h2>

            <div class="info-box">
                <h3>Features Demonstrated</h3>
                <p>
                    Pipeline stage visualization with drop-off rates and conversion metrics.
                    Tooltips show detailed conversion statistics.
                </p>
            </div>

            <div class="chart-container" role="region" aria-labelledby="chart3-title">
                <h3 id="chart3-title" class="sr-only">Pipeline Processing Funnel</h3>
                <div class="chart-canvas">
                    <canvas id="funnelChart" aria-label="Funnel chart showing conversion through pipeline stages"></canvas>
                </div>
            </div>
        </section>

        <!-- Example 4: Radar Chart -->
        <section class="section">
            <h2>Example 4: Enhanced Radar Chart</h2>

            <div class="info-box">
                <h3>Features Demonstrated</h3>
                <p>
                    Multi-dimensional performance comparison with normalized metrics.
                    Interactive legend to toggle sources on/off.
                </p>
            </div>

            <div class="chart-container" role="region" aria-labelledby="chart4-title">
                <h3 id="chart4-title" class="sr-only">Source Performance Comparison</h3>
                <div class="chart-canvas">
                    <canvas id="radarChart" aria-label="Radar chart comparing performance metrics across data sources"></canvas>
                </div>
            </div>
        </section>

        <!-- Example 5: Quality Metrics -->
        <section class="section">
            <h2>Example 5: Enhanced Quality Metrics</h2>

            <div class="info-box">
                <h3>Features Demonstrated</h3>
                <p>
                    Grouped bar chart showing quality metrics by source with normalized values.
                    Color-coded by metric type.
                </p>
            </div>

            <div class="chart-container" role="region" aria-labelledby="chart5-title">
                <h3 id="chart5-title" class="sr-only">Quality Metrics by Source</h3>
                <div class="chart-canvas">
                    <canvas id="qualityChart" aria-label="Bar chart showing quality metrics for each data source"></canvas>
                </div>
            </div>
        </section>

        <!-- Accessibility Testing Section -->
        <section class="section">
            <h2>Accessibility Testing Guide</h2>

            <div class="info-box">
                <h3>How to Test Keyboard Navigation</h3>
                <p>
                    1. Click on any chart to focus<br>
                    2. Use <code>Tab</code> to move between charts<br>
                    3. Use <code>‚Üê‚Üë‚Üí‚Üì</code> arrow keys to navigate data points<br>
                    4. Press <code>R</code> to reset zoom on time series chart<br>
                    5. Press <code>Escape</code> to clear tooltips
                </p>
            </div>

            <div class="info-box">
                <h3>Screen Reader Testing</h3>
                <p>
                    Each chart announces its title, current data point, and provides
                    navigation hints. Test with NVDA (Windows), JAWS (Windows), or VoiceOver (Mac/iOS).
                </p>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer style="text-align: center; padding: 40px 20px; color: #6B7280; font-size: 14px;">
        <p>Somali Dialect Classifier | Enhanced Visualizations v2.0</p>
        <p>Built with Chart.js, accessibility, and research in mind</p>
    </footer>

    <!-- JavaScript: Load and Render Charts -->
    <script>
        // Sample data generator
        function generateSampleMetrics() {
            const sources = ['Wikipedia-Somali', 'BBC-Somali', 'HuggingFace-MC4', 'Sprakbanken'];
            const metrics = [];
            const startDate = new Date('2025-10-15');

            for (let day = 0; day < 7; day++) {
                sources.forEach(source => {
                    const timestamp = new Date(startDate);
                    timestamp.setDate(timestamp.getDate() + day);

                    metrics.push({
                        timestamp: timestamp.toISOString(),
                        source: source,
                        records_written: Math.floor(Math.random() * 5000) + 1000,
                        success_rate: 0.85 + Math.random() * 0.15,
                        deduplication_rate: 0.1 + Math.random() * 0.2,
                        urls_discovered: Math.floor(Math.random() * 1000) + 500,
                        urls_fetched: Math.floor(Math.random() * 900) + 400,
                        urls_processed: Math.floor(Math.random() * 800) + 300,
                        avg_text_length: Math.floor(Math.random() * 2000) + 500,
                        min_text_length: 100,
                        max_text_length: 5000,
                        median_text_length: 1500,
                        records_per_minute: Math.random() * 100 + 50,
                        urls_per_second: Math.random() * 10 + 2
                    });
                });
            }

            return metrics;
        }

        // Initialize charts when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            const metrics = generateSampleMetrics();

            // Register crosshair plugin
            Chart.register(CrosshairPlugin);

            // 1. Time Series Chart
            const timeSeriesCanvas = document.getElementById('timeSeriesChart');
            if (timeSeriesCanvas) {
                try {
                    const timeSeriesChart = createEnhancedTimeSeriesChart(timeSeriesCanvas, metrics, {
                        title: 'Records Processed Over Time',
                        fillArea: true
                    });
                    console.log('‚úÖ Time series chart created');
                } catch (error) {
                    console.error('Error creating time series chart:', error);
                }
            }

            // 2. Source Comparison Chart
            const sourceCanvas = document.getElementById('sourceChart');
            if (sourceCanvas) {
                try {
                    const sourceChart = createEnhancedSourceComparisonChart(sourceCanvas, metrics, {
                        title: 'Data Source Contribution'
                    });

                    // Add filter event listener
                    sourceCanvas.addEventListener('chartFilter', (e) => {
                        const { source, value } = e.detail;
                        console.log(`Filtered by ${source}: ${value} records`);
                        alert(`You clicked on ${source}\nRecords: ${value.toLocaleString()}\n\nIn a real dashboard, this would filter other charts.`);
                    });

                    console.log('‚úÖ Source comparison chart created');
                } catch (error) {
                    console.error('Error creating source chart:', error);
                }
            }

            // 3. Funnel Chart
            const funnelCanvas = document.getElementById('funnelChart');
            if (funnelCanvas) {
                try {
                    const funnelChart = createEnhancedFunnelChart(funnelCanvas, metrics, {
                        title: 'Pipeline Processing Funnel'
                    });
                    console.log('‚úÖ Funnel chart created');
                } catch (error) {
                    console.error('Error creating funnel chart:', error);
                }
            }

            // 4. Radar Chart
            const radarCanvas = document.getElementById('radarChart');
            if (radarCanvas) {
                try {
                    const radarChart = createEnhancedRadarChart(radarCanvas, metrics, {
                        title: 'Source Performance Comparison'
                    });
                    console.log('‚úÖ Radar chart created');
                } catch (error) {
                    console.error('Error creating radar chart:', error);
                }
            }

            // 5. Quality Metrics Chart
            const qualityCanvas = document.getElementById('qualityChart');
            if (qualityCanvas) {
                try {
                    const qualityChart = createEnhancedHeatmapChart(qualityCanvas, metrics, {
                        title: 'Quality Metrics by Source'
                    });
                    console.log('‚úÖ Quality metrics chart created');
                } catch (error) {
                    console.error('Error creating quality chart:', error);
                }
            }

            // Announce charts loaded for screen readers
            announceToScreenReader('All charts loaded successfully. Use Tab to navigate between charts, arrow keys to explore data points.');
        });

        // Log accessibility features on load
        console.log(`
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  Enhanced Charts - Accessibility Features                 ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  ‚å®Ô∏è  Keyboard Navigation:                                  ‚ïë
‚ïë     Tab       - Move between charts                       ‚ïë
‚ïë     Arrow Keys- Navigate data points                      ‚ïë
‚ïë     R         - Reset zoom (time series)                  ‚ïë
‚ïë     Escape    - Clear tooltips                            ‚ïë
‚ïë                                                            ‚ïë
‚ïë  üé® Colorblind-Safe Palette:                              ‚ïë
‚ïë     Paul Tol's palette verified for:                      ‚ïë
‚ïë     - Deuteranopia                                        ‚ïë
‚ïë     - Protanopia                                          ‚ïë
‚ïë     - Tritanopia                                          ‚ïë
‚ïë                                                            ‚ïë
‚ïë  ‚ôø WCAG 2.1 AA Compliant:                                ‚ïë
‚ïë     - Screen reader support                               ‚ïë
‚ïë     - Focus indicators                                    ‚ïë
‚ïë     - Data table alternatives                             ‚ïë
‚ïë     - Reduced motion support                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        `);
    </script>
</body>
</html>
